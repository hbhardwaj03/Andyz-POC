(* 
Name: Bulk MO
Description: 
<<<<<<< HEAD
Author: Ramya//
 *)

Log "Logging in"
"M3/Application".open


// read user Name and Password for M3 Application from Login sheet of Datastore excel File
//run DataStore.ConfigValues UserName, Password, customerNumber, coType

set ExcelFile to workbook(ResourcePath("2-Datastore.xlsx"))

set worksheet to ExcelFile.Worksheet("Login")
Put Cell(worksheet,"A2") into UserName
Put Cell(worksheet,"B2") into Password
Put Cell(worksheet,"C2") into customerNumber
Put Cell(worksheet,"D2") into coType
Put Cell(worksheet,"E2") into PO
Put Cell(worksheet,"F2") into ItemCode
Put Cell(worksheet,"G2") into ItemQuantity
// call Login function 
"M3/Login".login UserName, Password

Log "Enter new order"
"M3/OIS300".open
"M3/OIS300".startNewOrder
Wait while ImageFound("M3/OIS300/CustomerNumberField/CustomerNumberField")

"M3/OIS300".enterCustomerNumber customerNumber, coType
"M3/OIS300".submitOIS100A
"M3/OIS300".enterCustomersPO PO
"M3/OIS300".submitOIS100G
"M3/OIS300".acceptPOWarning
"M3/OIS300".submitOIS100F
"M3/OIS300".submitOIS100H
"M3/OIS300".submitOIS100E
"M3/OIS300".submitOIS102H

Log "Enter order line"
put "M3/OIS101".recordCONumber() into coNumber
Log coNumber

//allowing this to be hard-coded because ultimately this script will
//read from an excel file instead of creating its own MOs
"M3/OIS101".enterItemCode ItemCode
"M3/OIS101".enterItemQuantity ItemQuantity
"M3/Configurations".config002

(*"M3/OIS101".enterItemCode ItemCode

if ItemCode = "TB7SX6CC" then 
	"M3/OIS101".enterItemQuantity productQuantity
	"M3/Configurations".config001
else
	"M3/OIS101".enterItemColor
	"M3/OIS101".configuratorA
end if*)

"M3/OIS101".closeFromOrderLines
(*>>>>>>>>>>>>>>>>>>>>>>>End of Order Entry>>>>>>>>>>>>>>>>>>>>>>>>>*)


(*>>>>>>>>>>>>>>>>>>>>>>>Start Scheduling>>>>>>>>>>>>>>>>>>>>>>>>*)
Log "Do scheduling"
"M3/PMS170".open
"M3/PMS170".lookUp coNumber
put "M3/PMS170".createScheduleNumber() into scheduleNumber
"M3/PMS170".scheduleNew scheduleNumber
"M3/PMS170".releaseMO
"M3/PMS170".close
"M3/PMS100".open
"M3/PMS100".lookupSchedule scheduleNumber
"M3/PMS100".printShopTraveler scheduleNumber
put "M3/PMS100".recordMO() into moNumber
"M3/PMS100".pick
"M3/PMS100".close

Log "Exit AGS"
"M3/Application".close

(*>>>>>>>>>>>>>>>>>>>>>>>Stop Scheduling>>>>>>>>>>>>>>>>>>>>>>>>*)

"M3/Application".open
=======
Author: Ramya & Ofir
*)

// declare login variables
global username
global password

// initialize login variables
"Datastore".setLoginVariables 3

// declare data variables
global coNum

// initialize data line counter
put 2 into dataIndex

(************** Start Test ***************)
repeat forever
	
	(************** Set up data *************)
	//initialize data variables
	DataStore.setDataScript2 dataIndex
	
	//increment counter
	put dataIndex + 1 into dataIndex
	
	//break if no more data
	if coNum is empty then exit repeat
	
	Log "CO# " & coNum
	
	(*>>>>>>>>>>>Scheduling>>>>>>>>>>>>*)
	// log in to application
	"Flows/Application".login username, password
	
	Log "Do scheduling"
	"M3/PMS170".open
	"M3/PMS170".lookUp(coNum)
	
	put "M3/PMS170".createScheduleNumber() into scheduleNumber
	"M3/PMS170".scheduleNew scheduleNumber
	"M3/PMS170".releaseMO
	"M3/PMS170".close
	"M3/PMS100".open
	"M3/PMS100".lookupSchedule scheduleNumber
	"M3/PMS100".printShopTraveler scheduleNumber
	put "M3/PMS100".recordMO() into moNumber
	"M3/PMS100".pick
	"M3/PMS100".close
	
	// add M3 manufacturing here by moving working code from function "doFullRun"
	
	// add KPack here by moving working code from function "doFullRun"
	
	// close application
	"Flows/Application".exitApp
end repeat

//post DCA check packed status
(*"M3/Application".open
>>>>>>> f3d3580a7a653eb20f3ff47931964e16c4407eab
"M3/Login".login username, password
"M3/OIS300".open
"M3/OIS300".lookupCO coNumber
"M3/OIS300".openDeliveryToolbox
put "M3/OIS300".recordDeliveryNumber into deliveryNumber
"M3/OIS300".confirmStatusPacked
"M3/OIS300".closeFromDeliveryToolbox

Log "Exit AGS"
"M3/Application".close

Log "CO: " & coNumber
Log "MO: " & moNumber
Log "Schedule: " & scheduleNumber
Log "Delivery: " & deliveryNumber
DataStore.recordRun coNumber, moNumber, scheduleNumber, deliveryNumber
*)

//////////////////////////////picking//////////////////////////////////////

(*Log "Do picking"
"M3/PMS100".open

WaitFor 20, "M3/PMS100/FacilityField"
Click "M3/PMS100/FacilityField"
TypeText controlKey, "a"
TypeText deleteKey
TypeText "061"
TypeText Return

"M3/PMS100".lookup_3 coNumber
"M3/PMS100".checkAllocationStatus
"M3/PMS100".openDeliveryToolbox
"M3/PMS100".checkDeliveryStatus
"M3/PMS100".checkPickingListsImage
Click "M3/PMS100/HPickingLists"
"M3/PMS100".checkPickingStatusImage*)

<<<<<<< HEAD

=======
/////////////////////////////////////////flagship////////////////////////////
(*Log "Shipping with Flagship"
"Web/Flagship".open
"Web/Flagship".login
"Web/Flagship".ship deliveryNumber
"Web/Flagship".close
"M3/Application".open

"M3/Login".login "ajenkins", "Acushnet#1"
"M3/OIS300".open
"M3/OIS300".lookupCO coNumber
"M3/OIS300".openDeliveryToolbox
"M3/OIS300".confirmStatusShipped
"M3/OIS300".closeFromDeliveryToolbox

Log "Exit AGS"
"M3/Application".close*)
>>>>>>> f3d3580a7a653eb20f3ff47931964e16c4407eab
//////////////////////////////////////manufacturingin m3 with kpack////

//prerequisite:yet to be handled(CO comes back form order entry)

///"M3/PMS100".open
//"M3/PMS100".checkfacility
//"M3/PMS100".lookup_4 coNumber
//"M3/PMS100".checkAllocationStatus
//click "M3/PMS070/close100"

Log "Do Manufacturing in M3"
"M3/PMS070".lookupMOnumber
"M3/PMS070".selectoperation
"M3/PMS070".compareOrderandManufQuantity

Click"M3/PMS070/Nextbutton"

// captured step for remains and manufacturing qty validation
"M3/PMS070". compareRemainsandManufQuantity
click "M3/PMS070/close"

"M3/PMS100".open
"M3/PMS100".lookup_4 coNumber

"M3/PMS100".checkMOStatus
click "M3/PMS070/close100"

"M3/PMS070".lookupMOnumber
"M3/PMS070".selectoperation8000
"M3/PMS070".compareOrderandManufQuantity
Click"M3/PMS070/Nextbutton"

// skipped steps related to Man compl flag and location values, as unable to find the fields

"M3/PMS070". compareRemainsandManufQuantity
click "M3/PMS070/close"



"M3/PMS070".checkMOStatus
"M3/PMS070".compareOrderandManufQuantity

/// packing with kpack////
"Web/KPack".OpenKpackUSVista
"Web/KPack".LoginToKpackUSVista
click "M3/KPack/OrderNum"
TypeText controlKey, "a"
TypeText deleteKey

TypeText "0013140411001"

Click "M3/KPack/LoadOrderutton"
Click "M3/KPack/ProductID"
Click "M3/KPack/FastPackDeselected"
Click "M3/KPack/Autopackselect"
Click "M3/KPack/Packbutton"
Click "M3/KPack/SelectBoxType"
Click "M3/KPack/SelectBoxtypedropdown"
"Web/KPack".compareOrderandPackedQuantity
<<<<<<< HEAD
Click "M3/KPack/Containercomplete"
Click "M3/KPack/OrderComplete"


=======
Click "M3/KPack/OrderComplete"*

to generateMOCO
	//log in to AGS
	Log "Logging in"
	"M3/Application".open
	
	//read in necessary data
	set ExcelFile to workbook(ResourcePath("2-Datastore.xlsx"))
	set worksheet to ExcelFile.Worksheet("Login")
	Put Cell(worksheet,"A3") into UserName
	Put Cell(worksheet,"B3") into Password
	Put Cell(worksheet,"C2") into customerNumber
	Put Cell(worksheet,"D2") into coType
	Put Cell(worksheet,"E2") into PO
	
	(*>>>>>>>>Start Order Entry>>>>>>>>>>>>>*)
"M3/Login".login UserName, Password

"Flows/OrderEntry".enterNewOrder customerNumber, coType, PO

put "Flows/OrderEntry".recordCONumber() into coNum

"Flows/OrderEntry".enterProductAndQuantity "TA5TVBPC", "1"

"M3/OIS101".closeFromOrderLines

Log coNum

Log "Exit AGS"
"M3/Application".close

//don't continue running the script
throw "Finished!", "some comment"
end generateMOCO

to doFullRun
	//read in necessary data
	set ExcelFile to workbook(ResourcePath("2-Datastore.xlsx"))
	set worksheet to ExcelFile.Worksheet("Login")
	Put Cell(worksheet,"A2") into UserName
	Put Cell(worksheet,"B2") into Password
	Put Cell(worksheet,"C2") into customerNumber
	Put Cell(worksheet,"D2") into coType
	Put Cell(worksheet,"E2") into PO
	
	(*>>>>>>>>Start Order Entry>>>>>>>>>>>>>*)
	"M3/Application".open
	
	"M3/Login".login UserName, Password
	
	"Flows/OrderEntry".enterNewOrder customerNumber, coType, PO
	
	put "Flows/OrderEntry".recordCONumber() into coNum
	
	"Flows/OrderEntry".enterProductAndQuantity "TA5TVBPC", "1"
	
	"M3/OIS101".closeFromOrderLines
	
	(*>>>>>>>>>>>Scheduling>>>>>>>>>>>>*)
	Log "Do scheduling"
	"M3/PMS170".open
	"M3/PMS170".lookUp(coNum)
	put "M3/PMS170".createScheduleNumber() into scheduleNumber
	"M3/PMS170".scheduleNew scheduleNumber
	"M3/PMS170".releaseMO
	"M3/PMS170".close
	"M3/PMS100".open
	"M3/PMS100".lookupSchedule scheduleNumber
	"M3/PMS100".printShopTraveler scheduleNumber
	put "M3/PMS100".recordMO() into moNumber
	"M3/PMS100".pick
	"M3/PMS100".close
	
	// implement manufacturing in M3 here first
	
	// implement KPack here first
end doFullRun
>>>>>>> f3d3580a7a653eb20f3ff47931964e16c4407eab

/////////////////////////////////////////flagship////////////////////////////
Log "Shipping with Flagship"
"Web/Flagship".open
"Web/Flagship".login
"Web/Flagship".ship deliveryNumber
"Web/Flagship".close
"M3/Application".open

"M3/Login".login "ajenkins", "Acushnet#1"
"M3/OIS300".open
"M3/OIS300".lookupCO coNumber
"M3/OIS300".openDeliveryToolbox
"M3/OIS300".confirmStatusShipped
"M3/OIS300".closeFromDeliveryToolbox

Log "Exit AGS"
"M3/Application".close





















Log "Read from Invoice with MetaViewer"
"Other/MetaViewer".openMV
"Other/MetaViewer".loginMV "ajenkins", "ajenkins"
"Other/MetaViewer".lookupMV "904845094"
--"Other/MetaViewer".lookupMV "904492748"
put "Other/MetaViewer".validateInvoice() into test
log test
//"Other/MetaViewer".closeMV






--                                                   -x-x-xx-x-x-xx-xx-x
--   Sandbox
-- to workaround before making any changes to the existing function or script
--****************************************************************************

---------------------------------------------------------------------
To ReadMVdata
	click "MetaViewer/PDF/MVFullscreen"
	Wait 5
	WaitFor 45,"MetaViewer/PDF/Titleist"
	
	put "MetaViewer/PDF/" into path
	
	--Put ReadValueByX("Invoice No",12)into InvoiceNoPDF
	set InvoiceNoPDF to ReadText((86,314))
	Log (InvoiceNoPDF  & " is the Invoice Number")
	
	Put ReadValueByX("Invoice Date",12)into InvoiceDatePDF
	
	set OrderNoPDF to ReadText((90,343))
	Log (OrderNoPDF  & " is the Order Number")
	
	set WhsPDF to ReadText((173,343))
	if WhsPDF is "06Y" then set WhsPDF to "060"
	if WhsPDF is "06B" then set WhsPDF to "061"
	Log WhsPDF && "is the warehouse number"
	
	set deliveryNumber to ReadText((250,343))
	Log deliveryNumber && "is delivery number"
	
	set customersPO to ReadText((437,345))
	Log customersPO && "is Customers PO"
	
	set AccountNo to ReadText((900,343))
	Log (AccountNo & " is the Account No of the Ship Account")
	
	--Put ReadAddressDetails ("Ship To") into (ShipToParty, ShipToPartyAddress1, ShipToPartyAddress2, ShipToPartyAddress3)
	--Put ReadAddressDetails ("Sold To") into(SoldToParty, SoldToAdrsLine1, SoldToAdrsLine2, SoldToAdrsLine3)
	--put ReadValueByX("Payment Terms",15) into(PaymentTerms)
	--put ReadValueByX("Payment Discount",15) into(PaymentDiscount)
	---put ReadValueByX("Delivery Method",15) into(DelMethd)
	--Put ReadValueByX("Due Date",15)into (DueDate)
	--------------------------------------------------------------------------------------------------------------------------------
	## to scroll page down -------  ******second half of PDF, Y cordinates changes ********
	Click(700,140)
	ScrollWheelDown 10
	if ImageFound(5, (Text: "Total Shipped Qty."))	
	else 
		ScrollWheelDown 2
		if ImageFound(5, (Text: "Total Shipped Qty."))
			ReadSingleLineItemDetails
		else
			Log "No Item Shipped"
		end if
	end if
	Put ReadValueByY("Net Order Total",264)into NetOrderTotal
	Put ReadValueByY("Shipping & Handling Total",302) into ShipCharge
	Put ReadValueByY("Total Invoice",256) into TotlInvoiceCost
	
	return (InvoiceNoPDF, InvoiceDatePDF,OrderNoPDF, WhsPDF,deliveryNumber,customersPO, AccountNo,ItemCode, ItemDscrptn, ShipdQty, UM, UnitPrice, Disc1, Disc2, Disc3, CstmChg, NetPrice, Extended,NetOrderTotal,ShipCharge,TotlInvoiceCost)
end ReadMVdata



to ReadAddressDetails txt
	put ImageLocation(Text: txt) into Loc
	set Party to ReadText(Loc +(0,21))
	Log Party &" : is " &txt &" Party"
	set AdrsLine1 to ReadText(Loc +(0,37))
	set AdrsLine2 to ReadText(Loc +(0,53))
	set AdrsLine3 to ReadText(Loc +(0,69))
	Log AdrsLine1 &" : is " &txt &"Party Address Line1"
	Log AdrsLine2 &" : is " &txt &" Party Address Line2"
	Log AdrsLine3 &" : is " &txt &"Party Address Line3"
	Return (Party, AdrsLine1, AdrsLine2, AdrsLine3)	
end ReadAddressDetails

--Put ReadValueByX()into ()
to ReadValueByX txt,y
	put ImageLocation(Text: txt) into Loc
	set Val to ReadText(Loc +(0,y))
	Log val &" : is " &txt
	return Val
end ReadValueByX

--Put ReadValueByY()into ()
to ReadValueByY txt,x
	put ImageLocation(Text: txt) into Loc
	set Val to ReadText(Loc +(x,0))
	Log val &" : is " &txt
	return Val
end ReadValueByY

to ReadSingleLineItemDetails
<<<<<<< HEAD
	Put ImageLocation(Text: "Total Shipped Qty.") into Loc
	set TotlShpdQty to ReadText(Loc+(220,0))
	set ItemDscrptn to ReadText(Loc -(0,33))
	set ItemCode to ReadText(Loc- (0,56))
	put  Loc - (20,52) into ItemLineLoc
	Log ItemLineLoc
	set ShipdQty to ReadText(ItemLineLoc+(220,0))
	set UM to ReadText(ItemLineLoc+(282,0))
	set UnitPrice to ReadText(ItemLineLoc+ (377,0))
	set Disc1 to ReadText (ItemLineLoc+(435,0)) --(ItemLineLoc+(470,0)
	set Disc2 to ReadText(ItemLineLoc+(506,0))
	set Disc3 to ReadText(ItemLineLoc+(566,0))
	set CstmChg to ReadText(ItemLineLoc+(629,0))
	set NetPrice to ReadText(ItemLineLoc+(730,0))
	set Extended to ReadText(ItemLineLoc+(836,0))
	Return(ItemCode, ItemDscrptn, ShipdQty, UM, UnitPrice, Disc1, Disc2, Disc3, CstmChg, NetPrice, Extended)
=======
	if ImageFound(5, (Text: "Total Shipped Qty."))
		Put ImageLocation(Text: "Total Shipped Qty.") into Loc
		set TotlShpdQty to ReadText(Loc+(220,0))
		set ItemDscrptn to ReadText(Loc -(0,33))
		set ItemCode to ReadText(Loc- (0,56))
		put  Loc - (20,52) into ItemLineLoc
		Log ItemLineLoc
		set ShipdQty to ReadText(ItemLineLoc+(220,0))
		set UM to ReadText(ItemLineLoc+(282,0))
		set UnitPrice to ReadText(ItemLineLoc+ (377,0))
		set Disc1 to ReadText (ItemLineLoc+(435,0)) --(ItemLineLoc+(470,0)
		set Disc2 to ReadText(ItemLineLoc+(506,0))
		set Disc3 to ReadText(ItemLineLoc+(566,0))
		set CstmChg to ReadText(ItemLineLoc+(629,0))
		set NetPrice to ReadText(ItemLineLoc+(730,0))
		set Extended to ReadText(ItemLineLoc+(836,0))
		Return(ItemCode, ItemDscrptn, ShipdQty, UM, UnitPrice, Disc1, Disc2, Disc3, CstmChg, NetPrice, Extended)
	else 
		Log "No Item Shipped"
		Exit handler
	end if
>>>>>>> c568ca3a241b0f6e03fcf713fbd35c952034f635
end ReadSingleLineItemDetails









(* 
Name: US-Gear-06
Description: Enter a basic custom CC Players 5 stand bag ,one personalization, FXG Delivery Method / BPG Delivery Term should apply to validate $5 per bag shows on Invoice
Author: Andy Jenkins
 *)

Log "Intializing Excel data sheet for This Script"
// read user Name and Password for M3 Application from Login sheet of Datastore excel File
//run DataStore.ConfigValues UserName, Password, customerNumber, coType
set ExcelFile to workbook(ResourcePath("1-Datastore.xlsx"))
set worksheet to ExcelFile.Worksheet("Login")
Put Cell(worksheet,"A2") into UserName
Put Cell(worksheet,"B2") into Password
Put Cell(worksheet,"C5") into customerNumber
Put Cell(worksheet,"D2") into coType
Put Cell(worksheet,"E4") into PO
Put Cell(worksheet,"F5") into itemCode
Put Cell(worksheet,"G2") into productQuantity
Put Cell(worksheet,"H2") into DCAUser
Put Cell(worksheet,"I2") into DCAPswrd

Log "Logging in"
"M3/Application".open
"M3/Login".login UserName, Password

"Flows/OrderEntry".enterNewOrder customerNumber, coType, PO

put "Flows/OrderEntry".recordCONumber() into coNumber

"Flows/OrderEntry".enterProduct itemCode

(*********************Begin Scheduling ***************)
"Flows/Scheduling".doScheduling coNumber

put "M3/PMS100".recordMO() into moNumber

"Flows/Picking".doPicking
(*********************End Scheduling ****************)

throw "Unsupported", "environment does not currently support DCA"

(*********************Begin Manufacturing *************)

"Flows/ManufacturinPacking".doManufacturing moNumber

(*********************End Manufacturing **************)

put "Flows/ManufacturingPacking".validatePacking(username,password,coNumber) into deliveryNumber

Log "CO: " & coNumber
Log "MO: " & moNumber
Log "Schedule: " & scheduleNumber
Log "Delivery: " & deliveryNumber
DataStore.recordRun coNumber, moNumber, scheduleNumber, deliveryNumber

(***********************************Begin Shipping with Flagship *****************)
Log "Shipping with Flagship"
"Web/Flagship".open
"Web/Flagship".login
"Web/Flagship".ship deliveryNumber
"Web/Flagship".close
"M3/Application".open

"M3/Login".login "ajenkins", "Acushnet#1"
"M3/OIS300".open
"M3/OIS300".lookupCO coNumber
"M3/OIS300".openDeliveryToolbox
"M3/OIS300".confirmStatusShipped
"M3/OIS300".closeFromDeliveryToolbox

Log "Exit AGS"
"M3/Application".close
(***********************************End Shipping  *****************)

(*X-X-X-X-X-X-X-X-X-X-X-X-X-X-X-X-X-X-X-X-X-X-X-X-X-X-X-X-X-X-XX-X-X-X-X-X-X-X-X-X-X-X-X-X-X-X-X-X-X-X-X-X-X-X-X-X-X-X-X-X-X*)






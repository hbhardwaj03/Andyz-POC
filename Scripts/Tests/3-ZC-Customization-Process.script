(*ZC Customization Process*)

// declare login variables
global username
global password

// initialize login variables
"Datastore".setLoginVariables 4

global customerNumber
global coType
global PO
global itemCode
global quantity
global coNumber
global product
global count

Datastore.setDataScript3

(************** Start flow ****************)
"Flows/Application".login username, password

(************** Order entry ***************)
"Flows/OrderEntry".enterNewOrder customerNumber, coType, PO
put "Flows/OrderEntry".recordCONumber() into coNumber
"Flows/OrderEntry".enterProductAndQuantity itemCode, quantity
"M3/OIS101".closeFromOrderLines

(************** Scheduling ***************)
"M3/PMS170".open
"M3/PMS170".lookUp(coNumber)
if ImageFound("M3/PMS170/Product_OrderLine") then
	Log "search the product"
	"M3/PMS170".select_Product product
else
	throw "Error","Product field is not Appears"
end if
"M3/PMS170".change_line_status
if Imagefound("M3/PMS170/Related") then
	
	// As per the Script ZCutomization the schedule number should stars with "300".
	
	put Cell(worksheet1, B1) into count
	put count + 1 into count
	put count into Cell(worksheet1, "B1")
	log "Cell value: " & Cell(worksheet1, B1)
	put 30025092017+(100000000*count) into scheduleNumber
	set scheduleNumber to scheduleNumber
	log "New schedule number: " & scheduleNumber
	
	"M3/PMS170".create_schedule_number scheduleNumber
else
	throw "Error","Schedulenumber is not created"
	
end if
"M3/PMS170".releaseMO
"M3/PMS170".close
"M3/MWS150".openMWS150
"M3/MWS150".search_order_in_MWS150 coNumber
"M3/MWS150".waitForRONum
//"M3/MWS150".recordReqnumber
put "M3/MWS150".recordReqnumber() into ReqNumber
"M3/MWS150".closeMWS150
"M3/MMS100".openMMS100
"M3/MMS100".searchReqnumber ReqNumber
"M3/MMS100".DeliveryToolBox
"M3/MMS100".Picking
"M3/MWS150".openMWS150
"M3/MWS150".search_order_in_MWS150 coNumber
"M3/MWS150".ReqOrderStatus
Put "M3/MWS150".RecordPoNumber() into poNumber 
(*"Web/KPack".OpenKpack
"Web/KPack".LoginToKpackZC10041
"Web/KPack".searchOrderInKpack poNumber*)
















